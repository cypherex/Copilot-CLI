# Example configuration for Task Queue Broker

broker:
  # Listen address
  host: 0.0.0.0

  # Listen port
  port: 6379

  # Maximum concurrent connections
  max_connections: 1000

  # Queue depth threshold (triggers backpressure)
  queue_depth_threshold: 100000

  # Heartbeat timeout for detecting dead workers
  heartbeat_timeout_secs: 30

  # Lease duration for task claims
  lease_duration_secs: 30

persistence:
  # Data directory for RocksDB
  data_dir: ./data

  # WAL sync interval in milliseconds
  wal_sync_interval_ms: 100

  # Retention period for completed tasks
  completed_task_retention_days: 7

  # Block cache size in MB
  block_cache_size_mb: 256

  # Write buffer size in MB
  write_buffer_size_mb: 64

raft:
  # Enable Raft clustering (false for single broker)
  enabled: false

  # Node ID in cluster
  node_id: node1

  # Peer addresses (other brokers in cluster)
  peers:
    - localhost:6380
    - localhost:6381

  # Election timeout in milliseconds
  election_timeout_ms: 1000

  # Heartbeat interval in milliseconds
  heartbeat_interval_ms: 300

api:
  # REST API port
  rest_port: 8080

  # gRPC API port
  grpc_port: 9090

  # Enable TLS for all connections
  enable_tls: false

  # Path to TLS certificate
  tls_cert_path: null

  # Path to TLS private key
  tls_key_path: null

auth:
  # Enable API key authentication
  enabled: false

  # API keys (bcrypt hashed)
  api_keys:
    # Example: replace with actual bcrypt hash
    # - key_hash: $2b$12$SixHEh4H3RU0A1w4z0JUYeWn2Uh3h6tEXQ8d4Q9q3P8kL2R1H9K
    #   permissions: [admin]

monitoring:
  # Prometheus metrics port
  prometheus_port: 9091

  # Log level: trace, debug, info, warn, error
  log_level: info

  # JSON structured logging
  structured_logging: true

worker:
  # Number of concurrent tasks per worker
  concurrency: 4

  # Heartbeat interval in seconds
  heartbeat_interval_secs: 15

  # Graceful shutdown timeout in seconds
  graceful_shutdown_timeout_secs: 60
